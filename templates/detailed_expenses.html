{% extends "templates/base.html" %}

{% block head %}
  <title>PFT: edit budget</title>

  <style type="text/css">
    .expense {
      color: #800000;
      text-align: right;
    }
    .income {
      color: #008000;
      text-align: right;
    }
    table.transactions {
      table-layout: fixed;
    }
    .transaction td {
      border-top: 1px solid #eee;
    }

    .date_cell {
      width: 100px;
    }
    td.date_cell {
      color: #999;
    }
    .amount_cell {
      width: 100px;
    }
    .description_cell {
      width: 450px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .account_cell {
      width: 150px;
    }
    .category_cell {
      width: 100px;
    }

    table.dataTable tr.odd {
      background-color: white;
    }
    .dataTables_info { padding-top: 0; }
    .dataTables_paginate { padding-top: 0; }
    .css_right { float: right; }
    #example_wrapper .fg-toolbar { font-size: 0.8em }
    #theme_links span { float: left; padding: 2px 10px; }
    .dataTables_wrapper .ui-toolbar {
      padding: 5px;
    }

  </style>

  <script type="text/javascript">
    // Init.

    {% for transaction in transactions_json %}
      pft.state.UpdateTransaction({{ transaction }});
    {% endfor %}
    $(function(){
      $('#transaction-table').dataTable({
        'bPaginate': false,
        'bLengthChange': false,
        'bFilter': true,
        'bSort': true,
        'bInfo': true,
        'bJQueryUI': true,
        'bAutoWidth': false});
    });
  </script>
{% endblock %}


{% block content %}
  <h3>
    <a href="/edit_budget?date={{ budget.GetStrDate() }}">Previous</a>
    Viewing {{ budget.GetStrDate() }}
    <a href="/edit_budget?date={{ budget.GetStrDate() }}">Next</a>
  </h3>

  <table id="transaction-table" class="transactions" cellpadding="0" cellspacing="0">
    <thead>
      <tr class="transaction">
        <th class="date_cell">Date</th>
        <th class="amount_cell">Amount</th>
        <th class="description_cell">Description</th>
        <th class="account_cell">Account</th>
        <th class="category_cell">Category</th>
      </tr>
    </thead>
    <tbody>
      {% for transaction in transactions %}
        <tr class="transaction">
          <td class="date_cell">{{ transaction.date.strftime('%a, %d %b') }}</td>
          {% if transaction.amount > 0 %}
            {% set amount_class = 'expense' %}
          {% else %}
            {% set amount_class = 'income' %}
          {% endif %}
          <td class="amount_cell {{ amount_class }}">{{ transaction.amount|abs|round(1) }}</td>
          <td class="description_cell description">{{ transaction.description }}</td>
          <td class="account_cell account">{{ transaction.account.name }}</td>
          <td class="category_cell category">
            {% if transaction.category %}
              {{ transaction.category.name }}
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
